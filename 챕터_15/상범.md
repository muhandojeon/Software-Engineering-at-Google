# 챕터 15 폐기

폐기: 이주를 순차적으로 진행하여 궁극적으로는 낡은 시스템을 완전히 걷어내는 과정

장점: 
1. 시스템을 운영하고 업그레이드하는 과정에서 수많은 중복 투자와 복잡성을 줄여줌
2. 자원을 아끼고 개발 속도를 높여줌

제대로 폐기시키지 못하면 시스템을 방치할 때보다 더 큰 비용 치룰 수 있음

시스템이 오래됐다고 해서 무조건 폐기시켜야 하는건 아님. 옛 것=구식 등식이 꼭 성립하진 않음

## 폐기는 왜 그리 어려운가?

1. 하이럼의 법칙에 의해 시스템은 사용자 수가 늘수록 설계자가 예상치 못한 방식으로 이용될 가능성이 커져서 폐기 작업을 그만큼 어렵게 만듬

사용자가 발견한 새로운 방법은 '되니깐 쓰는 것'이지 시스템이 '보장하는 동작'이 아님

> 백오피스에 특정 기능을 만들어놓고 오랜 뒤에 그 기능을 수정하려고보니 예측 불가능하게 사용하고 있는 곳이 많아서 수정하기가 매우 어려웠다는 경험을 지인에게 들었던게 생각나네요

2. 옛 시스템을향한 애착이 의외의 저항으로 나타나기도 함

엔지니어들에게 그들이 몇 년을 쏟아 구축한 무언가를 걷어내라고 설득하기란 말처럼 쉽지 않을때가 있음

> '언젠가는 폐기하게 될 시스템을 설계한다' 라는 마인드를 가지고 구축하면 좀 더 받아들이는데 도움이 될 것 같다

공감은 되지만 궁극적으론 스스로에게 피해가 돌아온다고 함

3. 비용을 확보해서 폐기를 진행하렴녀 '정치' 라는 관문을 통과해야 함

신기능 개발을 지연된다면 폐기시키는 편이 오히려 이득임을 이해관계자들에게 납득시키기가 어려움

## 폐기 유형

1. 권고 폐기: 기한이 없고 조직에서도 우선순위가 높지않은 경우에 해당

> 버전 낮은 구형 브라우저를 사용한다면 최신 브라우저를 사용해달라고 권고 하는 것도 예시가 되나?

구글의 경험에 비추어 보면 권고 폐기는 새로운 시스템이 사용자에게 주는 혜택이 매우 클 떄 효과가 좋다고 함

이주 도구를 제공해야 이주가 빠르게 이루어지고, 혜택이 '정말 좋다' 정도가 아니라 '혁신적이다' 수준이여야 한다고 함.  어중간한 혜택으론 사용자들이 이주를 잘 안한다고 함

2. 강제 폐기: 종료일 이후까지 이주를 끝내지 못한 시스템은 제대로 작동되지 않음

큰 조직에서 강제 폐기를 효율적으로 수행하려면 기존 시스템을 완전히 제거하는 역할을 전담할 팀을 하나 따로 구리는게 가장 좋다고 함 => 이주 관련 전문 지식을 집중 시킬 수 있음

이때 성공적으로 잘 이루어지기 위해 보상을 주고 조직 전체에 적용할 수 있도록 도구를 개발해야 됨 + 시스템에 문제 생겨도 책임 묻지 않기 + 일정대로 집행할 수 있는 권한 주기

### 폐기 경고

해당 시스템이 폐기 대상임을 프로그래밍적으로 알려주면 좋음

> @deprecated 주석 달기   

## 폐기 프로세스 관리

소유자 없이는 아무것도 폐기시키지 마라

폐기 전문 팀을 두고 주된 목표로 진행시켜야 됨

다른 일과 경쟁하게 만들면 폐기는 십중팔구 우선순위에서 밀리게 되어 제대로 된 관심을 받지 못한다

폐기처럼 '중요하지만 긴급하지 않은' 청소 업무는 20% 시간에 많이 이루어지며 엔지니어들이 코드베이스의 다른 부분을 살펴보는 기회가 되어 준다고 함

> 구글에는 업무시간의 20%를 본업 외의 다른 업무에 쓰는 문화가 있다고 합니다

### 폐기 도구

구글에서는 Code Search 같은 검색도구와 Kythe 같은 정적 분석 도구를 써서 폐기시킬 라이브러리를 누가 이용 중인지를 코드를 둘러보지 않고 알아본다고 하네요

그리고 폐기시킬 심볼의 참조가 모두 제거되었는지 확인하는 데 전역 테스트 스위트를 돌려본다고 하네요

> 작은 프로젝트면 @deprecated 검색으로..
