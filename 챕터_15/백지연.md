# CHAPTER 15 폐기

마이그레이션을 순차적으로 진행하여 궁극적으로는 낡은 시스템을 완전히 걷어내는 과정 = 폐기

## 15.1 폐기시키는 이유

시대에 뒤처졌고, 비슷한 기능의 대체재가 존재하는 시스템에는 폐기가 적합하다.  
폐기 대상을 신중하게 선택한 다음, 집중해서 빠르게 완료하는 게 중요하다.

## 15.2 폐기는 왜 그리 어려운가?

- 하이럼의 법칙에 의해 사용자가 늘어날수록 설계자가 예상하지 못한 방식으로 시스템이 이용되면서 폐기 작업을 어렵게 만든다.  
- 옛 시스템과 새로운 시스템의 기능이 일대일로 일치하지 않기에 옛 시스템의 쓰임 하나하나를 새로운 시스템 기준으로 확인해야 한다.
- 기존 코드 제거에 대한 거부감이 있다. 구글은 이를 완화하기 위해 제거된 코드라도 과거 이력 검색을 통해 다시 찾을 수 있도록 했다.
- 이해관계자들에게 폐기의 가치를 증명하는 등 정치라는 관문도 통과해야 한다.

---

시스템 구축 단계에서부터 시스템 폐기 계획이 필요하다.  
언젠가 매끄럽게 폐기하려면 시스템을 설계할 때 아래 내용을 고려해야 한다.
- 내 제품의 고객이 잠재적인 대체품으로 이주하기 얼마나 쉬울까?
- 내 시스템을 한 부분씩 점진적으로 교체하려면 어떻게 해야 할까?

## 15.3 폐기 유형

### 1. 권고 폐기

- 기한이 없고 조직에서도 우선순위가 높지 않은 경우
- 새로운 시스템의 출시를 알리고 얼리어답터들에게 이용을 권하기에 좋은 수단
- 새로운 시스템이 사용자에게 주는 혜택이 아주 클 때 효과 좋음
- 사용자에게 이주를 적극적으로 장려하지 않는 한 기존 시스템을 유지보수하는 데도 계속 자원 투입해야 함

### 2. 강제 폐기

- 낡은 시스템의 지원 종료일을 못 박는 형태
- 기존 시스템을 완전히 제거하는 역할을 전담할 팀을 하나 꾸리는 게 가장 좋음

---

이용자가 폐기 사실을 인지하고 마이그레이션을 준비할 수 있어야 하니까 프로그래밍적으로 해당 시스템이 폐기 대상임을 꼭 알려야 한다.   
폐기 경고 메시지에는 실행 가능성과 적시성이 담겨야 한다.  
- 실행 가능성 : 폐기될 시스템의 의존성을 떼어내기 위해 엔지니어가 수행할 다음 단계를 알려줘야 함
- 적시성 : 엔지니어가 해당 함수를 사용하는 코드를 작성할 때 함수 폐기 경고를 띄우는 게 좋음

## 15.4 폐기 프로세스 관리

- 폐기 전문가를 배정하여 하루빨리 제거한다.
- 폐기팀을 관리할 때도 측정할 수 있고 고객에게 가치를 전달하는 명확하고 점진적인 마일스톤을 세워야 한다.
- 도구를 낡은 시스템 폐기 관리에 유용하게 사용한다.
  - 발견 : 정적 분석 도구를 사용해서 폐기할 라이브러리를 누가 어떻게 이용 중인지 확인, 모두 제거됐는지 전역 테스트 스위트로 확인
  - 이주 : 새로운 라이브러리나 런타임 서비스를 이용하도록 코드 리뷰 남김
  - 퇴행 방지 : 새로운 코드에서 폐기 대상을 이용하지 않도록 정적 분석 프레임워크 차원에서 알림을 보내거나 자동 고침 버튼을 띄움
 
> 프로덕트 선셋이 결정된 시점에는 꼭 코드를 폐기해야 한다고 생각해요.  
> 이번 챕터에서 다룬 폐기 수준까지는 아니더라도 knip과 depcheck을 활용해 불필요한 코드를 틈틈이 정리하고 있어요.  
> Omlet이라고 하는 익스텐션을 사용하면 컴포넌트 및 props가 사용된 위치를 VS Code에서 바로 확인할 수 있어서 좋아요👍
