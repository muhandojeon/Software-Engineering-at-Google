# CHAPTER 11 테스트 개요

## 11.1 테스트를 작성하는 이유

구글 웹 서버(GWS)는 자동 테스트를 정책 차원에서 도입하게 되었고, 도입 1년 만에 핫픽스가 절반으로 줄었다.  
GWS의 변화는 구글의 테스트 문화를 격변시키는 분수령이 되었다.  
GWS 경험에서 배운 점은 제품 **결함 해결을 프로그래머의 능력에만 의존하면 안 된다**는 것이다.  

## 11.2 테스트 스위트 설계하기

소프트웨어 시스템은 계속 커지고 복잡해지기 때문에 자동 테스트가 필요하다.  
구글에서는 모든 테스트를 크기 기준으로 분류하며, 가능한 한 작은 테스트를 작성하라고 독려한다.  
- 작은 테스트 : 프로세스 하나에서 동작
- 중간 크기 테스트 : 기기 하나에서 동작
- 큰 테스트 : 자원을 원하는 만큼 사용해 동작

구글은 테스트 크기를 많이 강조하지만 테스트 범위도 중요하게 생각한다.  
테스트 범위란 주어진 테스트가 얼마나 많은 코드를 검증하느냐를 말한다.  
- 좁은 범위 테스트 : 단위 테스트와 비슷, 80%
- 중간 범위 테스트 : 통합 테스트와 비슷, 15%
- 넓은 범위 테스트 : functional test, end-to-end test, system test와 비슷, 5%

**구글은 되도록 작은 테스트, 좁은 범위 테스트를 추구한다.**  
테스트 구성 비율은 엔지니어링 생산성과 제품 신뢰도를 고려해 정한 것이다.  
**다양한 크기/범위의 테스트가 시스템 아키텍처와 조직의 현실에 맞게끔 혼합되어 있다면 좋은 테스트 스위트다.**

## 11.3 구글 규모의 테스트

구글은 모든 코드를 모노리포, 즉 하나의 리포지터리에서 관리한다.  
구글이 운영하는 모든 제품과 서비스의 거의 모든 코드가 한 곳에 담겨 있다.  
구글의 규모와 모노리포 정책, 제공하는 제품 수를 생각하면 엔지니어링 환경이 상당히 복잡함을 짐작할 수 있다.  

거대한 테스트 스위트를 잘 관리하는 비결은 테스트를 존중하는 문화다.  
훌륭한 기능을 출시했을 때와 똑같이 테스트를 견고하게 만든 엔지니어에게 보상한다.  
문화를 가꾸는 일과 더불어 린터 개발, 문서자료 보강, 테스트 인프라에도 투자해야 한다.

## 11.4 구글의 테스트 역사

신규 엔지니어가 반드시 거쳐야 하는 입사 OT에 자동 테스트의 가치를 이야기하는 한 시간짜리 수업이 추가되었다.  
OT를 마친 엔지니어는 팀에 배정되어 배운 대로 테스트를 작성했고, 그렇지 않은 팀원들에게 질문을 던지며 테스트 문화가 자리 잡았다.

사내 대시보드에서 모든 팀의 테스트 인증 레벨을 보여주고 테스트 작성하는 분위기를 만들었다.  

직원 모두가 매일 들르는 화장실 변기 앞에 전단지를 붙여두자는 아이디어에서 시작해 TotT(Testing on the Toilet)는 문화로 자리 잡았다.

## 11.5 자동 테스트의 한계

모든 종류의 테스트를 다 자동화할 수는 없다.  
검색 결과의 품질이나 음성/영상의 성능을 평가할 때는 사람의 판단이 개입되어야 한다.  
**탐색적 테스팅**은 창의력을 요구하는 작업으로, 검사 대상을 마치 고장내야 할 퍼즐로 취급한다.  
사람이 탐색적 테스팅으로 문제를 발견하는 즉시 자동 테스트를 추가하여 문제가 재발하지 않도록 예방해야 한다.
