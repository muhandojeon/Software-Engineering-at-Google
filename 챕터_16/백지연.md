# CHAPTER 16 버전 관리와 브랜치 관리

## 16.1 버전 관리란?

VCS(Version Control System)는 파일의 시간에 따른 변경 기록(버전)을 추적하는 시스템  

소프트웨어 엔지니어링 = 프로그래밍 + 시간의 흐름  
개발이란 본질적으로 분기하고 병합하며 전진하는 프로세스  
버전 관리는 여러 개발자와 여러 시점 사이를 교통정리하는 도구

VCS의 아키텍처가 설정, 정책, 확장성을 크게 좌우하므로 아키텍처 측면의 차이를 아는 것이 중요함  
**VCS 아키텍처에는 중앙집중형과 분산형이 있음**  
- 중앙집중형
  - 단 하나의 중앙 리포지터리를 이용하는 모델
  - 개별 개발자가 커밋하는 모든 코드는 결국 중앙 리포지터리로 커밋
  - 초창기에는 모든 VCS가 이 모델로 만들어짐
  - 리포지터리의 내용을 복사하는 건 자유지만, 파일을 편집하고 싶다면 먼저 락을 얻고 편집이 끝나면 반환해야 함
  - 진보한 중앙집중형 VCS는 한 사람이 락을 독점하는 대신 어느 버전과 동기화됐는지 추적하기 시작
- 분산형
  - Git, Mercurial에서 사용하는 패러다임
  - 리포지터리의 복제본(clone, fork)을 가지고 있다면 커밋할 수 있는 리포지터리를 소유한 것

## 16.2 브랜치 관리

**트렁크 기반 개발 조직**과 **장기간 유지되는 개발 브랜치가 적은 조직**일수록 기술적 성취가 뛰어나다.  
브랜치 정책을 단순하게 가져가면 일반적으로 더 나은 결과를 얻을 수 있다.

> 전 TBD에 그렇게 긍정적이진 않아요 아직은 Git flow로 충분한 것 같슴다

## 16.3 버전 관리 @ 구글

구글의 소스 코드 대부분은 모노리포에서 관리되며 약 5만여 엔지니어에게 공유된다.  
**자체 개발한 중앙집중형 VCS인 Piper를 이용한다.**  
덕분에 소유권과 승인이라는 개념을 더 명백하게 정의하고 VCS 차원에서 통제할 수 있다.

**구글 버전 관리 정책의 중심에는 One-Version이 있다.**  
모든 의존성이 우리 리포지터리에 담겨 있고 각 의존성은 단 하나의 안정된 버전만 존재해야 한다는 뜻이다.  
개발자가 '이 구성요소는 어떤 버전을 사용해야 하죠?'라고 묻는 상황을 만들지 않아야 한다.  
어디로 커밋해야 할지, 혹은 어느 버전을 이용해야 할지 선택하는 일을 없애면 일이 매우 단순해진다.

## 16.4 모노리포(단일 리포지터리)

모노리포 방식은 One-Version을 고수하기 쉽다.  
중요한 것은 모노리포냐 아니냐가 아니라 One-Version 원칙을 최대한 준수하는 것이다.  

개인정보, 법 준수, 비밀 유지, 보안 등의 요구사항이 모든 프로젝트에 동일하게 적용되는 조직이라면 모노리포가 좋다.  
그렇지 않다면 모노리포라는 이상을 추구하되 같은 경험을 다른 방식으로 구현해내는 방법을 찾아라.

## 16.5 버전 관리의 미래

모노리포에 대한 가장 큰 우려 = 모든 것을 하나의 리포지터리에 담을 수 있는 기술이 있느냐  
어느 리포지터리가 트렁크 역할을 하는지, 어느 변경이 먼저 일어났는지, 의존성은 어떤 식으로 기술하는지가 모두 일관된다면,  
이질적인 여러 리포지터리들을 묶어 하나의 더 큰 가상 모노리포로 다루는 일이 그리 어렵지 않을 것  
VCS는 확장성을 개선해 더 큰 리포지터리를 지원할 것으로 예상
